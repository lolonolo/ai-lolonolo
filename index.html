<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lolonolo AI Asistan</title>
    
    <link rel="icon" type="image/png" href="https://lolonolo.com/wp-content/uploads/2025/04/lolonolo-favicon.png">
    <link rel="apple-touch-icon" href="https://lolonolo.com/wp-content/uploads/2025/04/lolonolo-favicon.png">
    
    <script>
        window.ezstandalone = window.ezstandalone || {};
        ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
    <script src="https://the.gatekeeperconsent.com/cmp.min.js" async></script>
    <script src="https://the.gatekeeperconsent.com/ccpa/v2/standalone.js" async></script>
    <script src="//www.ezojs.com/ezoic/sa.min.js" async></script>
    
    <style>
        :root {
            --background-color: #F8F9FA; 
            --container-bg: #FFFFFF; 
            --sidebar-bg: #ECEFF1;
            --primary-text: #202124; 
            --secondary-text: #5F6368; 
            --accent-color: #1A73E8;
            --accent-hover: #1765CC; 
            --border-color: #DADCE0; 
            --user-bubble-bg: #D3E3FD;
            --assistant-bubble-bg: #F1F3F4;
        }
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; margin: 0; background-color: var(--background-color); color: var(--primary-text); }
        .main-container { display: flex; height: 100vh; padding-bottom: 100px; }
        .sidebar { width: 260px; background-color: var(--sidebar-bg); padding: 15px; display: flex; flex-direction: column; border-right: 1px solid var(--border-color); padding-bottom: 200px; }
        .new-chat-btn { display: flex; align-items: center; justify-content: center; width: 100%; padding: 12px; margin-bottom: 20px; font-size: 1rem; border: 1px solid var(--border-color); border-radius: 8px; cursor: pointer; background-color: var(--container-bg); color: var(--primary-text); transition: background-color 0.2s; }
        .new-chat-btn:hover { background-color: #f1f1f1; }
        .chat-history { flex-grow: 1; overflow-y: auto; }
        .chat-history h3 { font-size: 0.9rem; color: var(--secondary-text); margin: 0 0 10px 0; padding: 0 10px; }
        .chat-history ul { list-style: none; padding: 0; margin: 0; }
        .no-history { text-align: center; color: var(--secondary-text); font-size: 0.9rem; padding: 20px; }
        .sidebar-footer { margin-top: auto; padding-top: 15px; border-top: 1px solid var(--border-color); text-align: center; }
        .footer-link { display: block; text-decoration: none; color: var(--secondary-text); font-size: 0.85rem; padding: 8px 0; border-radius: 6px; transition: background-color 0.2s, color 0.2s; }
        .footer-link:hover { background-color: #e0e0e0; color: var(--primary-text); }
        .premium-link { font-weight: bold; color: var(--accent-color); margin-bottom: 10px; }
        .social-icons { display: flex; justify-content: center; gap: 15px; margin-bottom: 10px; }
        .social-icons a { color: var(--secondary-text); transition: color 0.2s; }
        .social-icons a:hover { color: var(--primary-text); }
        .social-icons svg { width: 22px; height: 22px; }
        .chat-view { flex-grow: 1; display: flex; flex-direction: column; background-color: var(--container-bg); }
        .chat-window { flex-grow: 1; padding: 20px; overflow-y: auto; }
        .message-wrapper { display: flex; margin-bottom: 20px; align-items: flex-end; }
        .avatar { width: 40px; height: 40px; border-radius: 10px; background-color: #FF4500; color: #FFD700; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2rem; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3); margin-right: 12px; flex-shrink: 0; }
        .message { max-width: 80%; padding: 12px 18px; border-radius: 18px; line-height: 1.5; word-wrap: break-word; }
        .user { justify-content: flex-end; }
        .assistant { justify-content: flex-start; }
        .user .message { background-color: var(--user-bubble-bg); color: var(--primary-text); border-bottom-right-radius: 4px; }
        .assistant .message { background-color: var(--assistant-bubble-bg); color: var(--primary-text); border-bottom-left-radius: 4px; white-space: pre-wrap; }
        .assistant .message a { color: var(--accent-color); font-weight: bold; text-decoration: none; }
        .assistant .message a:hover { text-decoration: underline; }
        .input-area-wrapper { padding: 1.5rem; border-top: 1px solid var(--border-color); }
        .input-area { display: flex; max-width: 700px; margin: 0 auto; background-color: var(--assistant-bubble-bg); border-radius: 24px; padding: 5px; }
        textarea { flex-grow: 1; border: none; background: transparent; padding: 10px; font-size: 1rem; resize: none; overflow-y: hidden; max-height: 150px; outline: none; }
        button { padding: 10px 15px; margin: 3px; font-size: 1rem; color: white; background-color: var(--accent-color); border: none; border-radius: 18px; cursor: pointer; transition: background-color 0.2s; }
        button:hover:not(:disabled) { background-color: var(--accent-hover); }
        button:disabled { background-color: #90baf9; cursor: not-allowed; }
        @media (max-width: 768px) { .sidebar { display: none; } }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="sidebar">
            <button class="new-chat-btn" id="new-chat-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 8px;"><path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg>
                New Chat
            </button>
            <div class="chat-history">
                <h3>Geçmiş Sohbetler</h3>
                <ul id="history-list"></ul>
                <div class="no-history">Henüz sohbet geçmişiniz yok.</div>
            </div>
           <div class="social-icons">
    <a href="https://x.com/lolonolo_com" target="_blank" rel="noopener noreferrer" title="Twitter">
        <svg viewBox="0 0 24 24" fill="currentColor">...</svg>
    </a>
    <a href="https://www.instagram.com/lolonolo_com/" target="_blank" rel="noopener noreferrer" title="Instagram">
        <svg viewBox="0 0 24 24" fill="currentColor">...</svg>
    </a>
    <a href="https://www.youtube.com/@lolonolocom" target="_blank" rel="noopener noreferrer" title="YouTube">
        <svg viewBox="0 0 24 24" fill="currentColor">...</svg>
    </a>
</div>
                <a href="mailto:lolonolo@lolonolo.com" class="footer-link">lolonolo@lolonolo.com</a>
            </div>
        </div>
        <div class="chat-view">
            <div class="chat-window" id="chat-window"></div>
            <div class="input-area-wrapper">
                <div class="input-area">
                    <textarea id="prompt-input" placeholder="Bir mesaj yaz..." rows="1"></textarea>
                    <button id="ask-button">Gönder</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const chatWindow = document.getElementById('chat-window');
            const promptInput = document.getElementById('prompt-input');
            const askButton = document.getElementById('ask-button');
            const newChatBtn = document.getElementById('new-chat-btn');
            let inFallbackMode = false;

            const addMessage = (htmlContent, sender) => {
                const wrapper = document.createElement('div');
                wrapper.classList.add('message-wrapper', sender);
                if (sender === 'assistant') {
                    const avatar = document.createElement('div');
                    avatar.classList.add('avatar');
                    avatar.textContent = 'LN';
                    wrapper.appendChild(avatar);
                }
                const messageElement = document.createElement('div');
                messageElement.classList.add('message');
                messageElement.innerHTML = htmlContent;
                wrapper.appendChild(messageElement);
                chatWindow.appendChild(wrapper);
                chatWindow.scrollTop = chatWindow.scrollHeight;
                return messageElement;
            };

            const sendMessage = async () => {
                const prompt = promptInput.value.trim();
                if (!prompt) return;
                addMessage(prompt, 'user');
                promptInput.value = '';
                promptInput.style.height = 'auto';
                askButton.disabled = true;

                if (inFallbackMode) {
                    const searchQuery = encodeURIComponent(prompt);
                    const searchUrl = `https://lolonolo.com/?s=${searchQuery}`;
                    const searchMessage = `Aradığınız konu için Lolonolo'daki sonuçları burada bulabilirsiniz: <a href="${searchUrl}">${prompt}</a>`;
                    addMessage(searchMessage, 'assistant');
                    inFallbackMode = false;
                    askButton.disabled = false;
                    promptInput.focus();
                    promptInput.placeholder = 'Bir mesaj yaz...';
                    return;
                }

                const responseElement = addMessage('...', 'assistant');
                try {
                    const response = await fetch('/api/chat', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ prompt: prompt }),
                    });
                    if (!response.ok) throw new Error('Network response was not ok.');
                    const data = await response.json();
                    if (data.status === 'fallback_initiated') {
                        inFallbackMode = true;
                        promptInput.placeholder = 'Aramak istediğiniz konuyu yazın...';
                    }
                    responseElement.innerHTML = data.reply;
                } catch (error) {
                    inFallbackMode = true;
                    promptInput.placeholder = 'Aramak istediğiniz konuyu yazın...';
                    responseElement.innerHTML = `Şu an yapay zeka meşgul veya bir sorunla karşılaştı.<br><br>Ancak aradığınız konuyla ilgili Lolonolo'da bir arama yapabilirsiniz. Lütfen aramak istediğiniz konuyu yazın.<br>Örnek: <strong>Anatomi 2025 vize soruları</strong>`;
                } finally {
                    askButton.disabled = false;
                    promptInput.focus();
                }
            };

            const startNewChat = () => {
                 chatWindow.innerHTML = '';
                 addMessage('Merhaba, ben LOLONOLO. Hangi ders hakkında bilgi almak istemiştiniz?', 'assistant');
                 inFallbackMode = false;
                 promptInput.placeholder = 'Bir mesaj yaz...';
            }

            newChatBtn.addEventListener('click', startNewChat);
            askButton.addEventListener('click', sendMessage);
            promptInput.addEventListener('keydown', (event) => {
                if (event.key === 'Enter' && !event.shiftKey) {
                    event.preventDefault();
                    sendMessage();
                }
            });
            promptInput.addEventListener('input', () => {
                promptInput.style.height = 'auto';
                promptInput.style.height = `${promptInput.scrollHeight}px`;
            });

        
        
            
            startNewChat();
        });
    </script>
</body>
</html>
